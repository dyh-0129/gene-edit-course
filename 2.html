<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>åŸºå› ç¼–è¾‘ç§‘æ™®è¯¾ç¨‹ | Kimi AI å¢å¼ºç‰ˆ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root {
      --primary: #1a2980;
      --secondary: #26d0ce;
      --glass: rgba(255, 255, 255, 0.55);
      --shadow: 0 8px 32px rgba(31, 38, 135, 0.15);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
      background: linear-gradient(135deg, #e0e7ff 0%, #d6e4ff 100%);
      color: #333;
      line-height: 1.6;
      min-height: 100vh;
    }

    /* ===== å¯¼èˆªæ  ===== */
    .navbar {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: var(--glass);
      backdrop-filter: blur(12px);
      box-shadow: var(--shadow);
      z-index: 999;
      padding: 0 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.3);
    }

    .nav-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      height: 70px;
    }

    .nav-logo {
      font-size: 1.6em;
      font-weight: 700;
      color: var(--primary);
      margin-right: 50px;
      letter-spacing: -0.5px;
    }

    .nav-menu {
      display: flex;
      list-style: none;
      gap: 35px;
    }

    .nav-item {
      position: relative;
    }

    .nav-link {
      text-decoration: none;
      color: #5f6368;
      font-weight: 500;
      padding: 10px 0;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .nav-link:hover {
      color: var(--primary);
    }

    /* ===== ä¸‹æ‹‰èœå•ï¼ˆä¿®å¤å®šä½ï¼‰ ===== */
    .dropdown {
      position: absolute;
      top: 100%;
      left: 0;
      background: var(--glass);
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
      border-radius: 12px;
      padding: 12px 0;
      min-width: 270px;
      opacity: 0;
      visibility: hidden;
      transform: translateY(10px);
      transition: all 0.3s ease;
      border: 1px solid rgba(255, 255, 255, 0.3);
      transform-origin: top left;
      z-index: 1001;
    }

    .nav-item:hover .dropdown {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .dropdown-item {
      padding: 14px 25px;
      color: #5f6368;
      text-decoration: none;
      display: block;
      transition: all 0.3s ease;
      cursor: pointer;
      border-left: 3px solid transparent;
    }

    .dropdown-item:hover {
      background: rgba(26, 41, 128, 0.05);
      color: var(--primary);
      border-left: 3px solid var(--primary);
      padding-left: 28px;
    }

    /* ===== é¡µé¢å®¹å™¨ ===== */
    .main-content {
      margin-top: 90px;
      padding: 30px 20px;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      background: var(--glass);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      box-shadow: var(--shadow);
      padding: 40px;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .chapter-title {
      font-size: 2.5em;
      color: var(--primary);
      margin-bottom: 25px;
      text-align: center;
      font-weight: 700;
      letter-spacing: -0.5px;
      background: linear-gradient(to right, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .section-title {
      font-size: 1.6em;
      color: var(--secondary);
      margin: 30px 0 15px;
      font-weight: 600;
      position: relative;
      padding-left: 15px;
    }

    .section-title::before {
      content: '';
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 6px;
      height: 70%;
      background: linear-gradient(to bottom, var(--primary), var(--secondary));
      border-radius: 3px;
    }

    .content-text {
      margin-bottom: 20px;
      text-align: justify;
      color: #444;
    }

    .video-container {
      margin: 30px 0;
      text-align: center;
    }

    .quiz-button {
      background: linear-gradient(to right, var(--primary), var(--secondary));
      color: #fff;
      border: none;
      padding: 14px 30px;
      border-radius: 30px;
      cursor: pointer;
      font-size: 1.05em;
      margin: 30px auto 0;
      display: block;
      transition: all 0.3s ease;
      box-shadow: 0 5px 15px rgba(26, 41, 128, 0.2);
    }

    .quiz-button:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(26, 41, 128, 0.3);
    }

    /* ===== é—®ç­”åŒºåŸŸ ===== */
    .qa-input {
      width: 100%;
      min-height: 120px;
      padding: 15px;
      border: 1px solid #ccc;
      border-radius: 12px;
      font-size: 1em;
      resize: vertical;
      background: rgba(255, 255, 255, 0.7);
    }

    .qa-submit {
      margin-top: 15px;
      padding: 12px 25px;
      background: linear-gradient(to right, var(--primary), var(--secondary));
      color: #fff;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .qa-response {
      margin-top: 20px;
      padding: 20px;
      background: rgba(255, 255, 255, 0.8);
      border-radius: 12px;
      display: none;
      line-height: 1.8;
    }

    /* ===== feature å¡ç‰‡ ===== */
    .feature-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 30px;
      margin-top: 40px;
    }

    .feature-card {
      background: var(--glass);
      backdrop-filter: blur(5px);
      border-radius: 16px;
      padding: 30px;
      text-align: center;
      box-shadow: var(--shadow);
      border: 1px solid rgba(255, 255, 255, 0.3);
      cursor: pointer;
      transition: all 0.4s ease;
    }

    .feature-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
    }

    .feature-icon {
      font-size: 2.5em;
      margin-bottom: 15px;
      background: linear-gradient(to right, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .feature-title {
      font-size: 1.3em;
      margin-bottom: 10px;
      color: var(--primary);
    }

    /* ===== é¡µé¢åˆ‡æ¢ ===== */
    .page { display: none; }
    .page.active { display: block; animation: fadeIn 0.5s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body>

<!-- å¯¼èˆªæ  -->
<nav class="navbar">
  <div class="nav-content">
    <div class="nav-logo">ğŸ§¬ åŸºå› ç¼–è¾‘è¯¾ç¨‹</div>
    <ul class="nav-menu">
      <li class="nav-item">
        <a class="nav-link" onclick="showHome()">ä¸»é¡µ</a>
      </li>
      <li class="nav-item">
        <a class="nav-link">è¯¾ç¨‹å¯¼è§ˆ</a>
        <div class="dropdown">
          <a class="dropdown-item" onclick="showChapter(1)">ç¬¬ä¸€ç« ï¼šåŸºå› ç¼–è¾‘å…¥é—¨</a>
          <a class="dropdown-item" onclick="showSection(2, 1)">2.1 ZFNæŠ€æœ¯</a>
          <a class="dropdown-item" onclick="showSection(2, 2)">2.2 TALENæŠ€æœ¯</a>
          <a class="dropdown-item" onclick="showSection(2, 3)">2.3 CRISPR-Cas9æŠ€æœ¯</a>
          <a class="dropdown-item" onclick="showSection(2, 4)">2.4 æŠ€æœ¯å‡çº§æ–¹å‘</a>
          <a class="dropdown-item" onclick="showChapter(3)">ç¬¬ä¸‰ç« ï¼šåº”ç”¨åœºæ™¯</a>
          <a class="dropdown-item" onclick="showChapter(4)">ç¬¬å››ç« ï¼šä¼¦ç†ä¸å®‰å…¨</a>
          <a class="dropdown-item" onclick="showChapter(5)">ç¬¬äº”ç« ï¼šæœªæ¥å±•æœ›</a>
        </div>
      </li>
      <li class="nav-item">
        <a class="nav-link" onclick="showQA()">æ™ºèƒ½é—®ç­”</a>
      </li>
    </ul>
  </div>
</nav>

<!-- ä¸»å†…å®¹ -->
<div class="main-content">
  <!-- ä¸»é¡µ -->
  <div id="homePage" class="container page active">
    <h1 style="font-size: 2.5em; text-align: center; margin-bottom: 20px; background: linear-gradient(to right, #1a2980, #26d0ce); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">æ¬¢è¿æ¥åˆ°åŸºå› ç¼–è¾‘ç§‘æ™®è¯¾ç¨‹</h1>
    <p style="text-align: center; color: #666; margin-bottom: 40px;">æ·±å…¥äº†è§£åŸºå› ç¼–è¾‘æŠ€æœ¯çš„åŸç†ã€åº”ç”¨ä¸æœªæ¥å‘å±•</p>
    <div class="feature-grid">
      <div class="feature-card" onclick="showChapter(1)">
        <div class="feature-icon">ğŸ“š</div>
        <div class="feature-title">ç³»ç»ŸåŒ–è¯¾ç¨‹</div>
        <p>ä»åŸºç¡€æ¦‚å¿µåˆ°å‰æ²¿æŠ€æœ¯ï¼Œå…¨é¢è¦†ç›–åŸºå› ç¼–è¾‘çŸ¥è¯†ä½“ç³»</p>
      </div>
      <div class="feature-card" onclick="startQuizFromHome()">
        <div class="feature-icon">ğŸ¯</div>
        <div class="feature-title">äº’åŠ¨å­¦ä¹ </div>
        <p>æ¯ç« é…æœ‰ç»ƒä¹ é¢˜ï¼Œå·©å›ºå­¦ä¹ æˆæœ</p>
      </div>
      <div class="feature-card" onclick="showQA()">
        <div class="feature-icon">ğŸ¤–</div>
        <div class="feature-title">AIé—®ç­”</div>
        <p>æ™ºèƒ½åŠ©æ‰‹ä¸ºæ‚¨è§£ç­”åŸºå› ç¼–è¾‘ç›¸å…³é—®é¢˜</p>
      </div>
    </div>
  </div>

  <!-- ç« èŠ‚å†…å®¹ -->
  <div id="chapterPage" class="container page">
    <h1 class="chapter-title" id="chapterTitle"></h1>
    <div id="chapterContent"></div>
    <div class="video-container" id="videoContainer"></div>
    <button class="quiz-button" onclick="startQuiz()">å¼€å§‹ç­”é¢˜</button>
  </div>

  <!-- ç­”é¢˜é¡µ -->
  <div id="quizPage" class="container page">
    <h1 class="chapter-title">ç« èŠ‚æµ‹è¯•</h1>
    <div id="quizContent"></div>
    <button class="quiz-button" onclick="submitQuiz()">æäº¤ç­”æ¡ˆ</button>
  </div>

  <!-- ç»“æœé¡µ -->
  <div id="resultPage" class="container page">
    <h1 class="chapter-title">æµ‹è¯•ç»“æœ</h1>
    <div class="score" id="scoreDisplay" style="font-size:3em; text-align:center; margin-bottom:20px;"></div>
    <div id="resultDetails"></div>
    <div class="result-buttons">
      <button class="result-btn retry-btn" onclick="retryQuiz()">é‡æ–°ç­”é¢˜</button>
      <button class="result-btn next-btn" onclick="nextChapter()">å­¦ä¹ ä¸‹ä¸€ç« </button>
    </div>
  </div>

  <!-- æ™ºèƒ½é—®ç­” -->
  <div id="qaPage" class="container page">
    <h1 class="chapter-title">æ™ºèƒ½é—®ç­”ï¼ˆKimi AIï¼‰</h1>
    <textarea class="qa-input" id="questionInput" placeholder="è¯·è¾“å…¥æ‚¨å…³äºåŸºå› ç¼–è¾‘çš„é—®é¢˜..."></textarea>
    <button class="qa-submit" onclick="submitQuestion()">æäº¤é—®é¢˜</button>
    <div class="qa-response" id="qaResponse"></div>
  </div>
</div>

<script>
// ===== é…ç½® =====
const MOONSHOT_API_KEY = 'ä½ çš„key'; // â† ç”³è¯·ï¼šhttps://platform.moonshot.cn/

// ===== æ•°æ® =====
const courseData = {
  1: {
    title: "ç¬¬ä¸€ç«  åŸºå› ç¼–è¾‘å…¥é—¨ï¼šä»'ç”Ÿå‘½å¯†ç 'åˆ°æŠ€æœ¯æ¼”è¿›",
    content: `
      <div class="section-title">åŸºå› ä¸DNAçš„å…³ç³»</div>
      <div class="content-text">DNAæ˜¯æ‰¿è½½é—ä¼ ä¿¡æ¯çš„å¤§åˆ†å­ï¼ŒåŸºå› æ˜¯DNAä¸Šæ§åˆ¶ç”Ÿç‰©æ€§çŠ¶çš„ç‰¹å®šç‰‡æ®µã€‚å°±åƒæ‰‹æœºç³»ç»Ÿä»£ç å†³å®šæ‰‹æœºåŠŸèƒ½ä¸€æ ·ï¼ŒåŸºå› å·®å¼‚å†³å®šäº†ç”Ÿç‰©å·®å¼‚ã€‚</div>
      <div class="section-title">åŸºå› ç¼–è¾‘çš„å®šä¹‰</div>
      <div class="content-text">åŸºå› ç¼–è¾‘æ˜¯é€šè¿‡æŠ€æœ¯æ‰‹æ®µå¯¹åŸºå› åºåˆ—è¿›è¡Œ"ä¿®æ”¹ã€åˆ é™¤ã€æ’å…¥"çš„ç²¾å‡†æ“ä½œï¼Œæœ¬è´¨æ˜¯è°ƒæ•´é—ä¼ ä¿¡æ¯ã€‚ç›¸æ¯”ä¼ ç»Ÿæ‚äº¤è‚²ç§ï¼ŒåŸºå› ç¼–è¾‘å¦‚åŒå…‰æ ‡å®šä½ä¿®æ”¹æ–‡æ¡£ï¼Œæ›´åŠ ç²¾å‡†ã€‚</div>
      <div class="section-title">æŠ€æœ¯å‘å±•å†ç¨‹</div>
      <div class="content-text">â€¢ 1970å¹´ä»£ï¼šé™åˆ¶æ€§å†…åˆ‡é…¶ï¼ˆåˆä»£å‰ªåˆ€ï¼‰<br>â€¢ 2000å¹´ä»£ï¼šZFN/TALENæŠ€æœ¯ï¼ˆè¿›é˜¶å‰ªåˆ€ï¼‰<br>â€¢ 2012å¹´ï¼šCRISPR-Cas9æŠ€æœ¯ï¼ˆæ™ºèƒ½å‰ªåˆ€ï¼‰</div>
    `,
    video: '<iframe src="//player.bilibili.com/player.html?isOutside=true&aid=464164346&bvid=BV1dL411u7DW&cid=441171372&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="width:100%;height:370px;border-radius:12px;"></iframe>',
    questions: [
      {
        question: "æ–‡ä¸­ç”¨'ç”Ÿå‘½è¯´æ˜ä¹¦'æ¯”å–»çš„æ˜¯ä¸‹åˆ—å“ªç§ç‰©è´¨ï¼Ÿ",
        options: ["A. åŸºå› ", "B. DNA", "C. è›‹ç™½è´¨", "D. æŸ“è‰²ä½“"],
        answer: 1,
        explanation: "ç¬¬ä¸€ç« æ˜ç¡®æåˆ°'ç”¨ç”Ÿå‘½è¯´æ˜ä¹¦æ¯”å–»DNAï¼Œè¯´æ˜å…¶æ˜¯æ‰¿è½½é—ä¼ ä¿¡æ¯çš„å¤§åˆ†å­'"
      },
      {
        question: "ä¸‹åˆ—å…³äºåŸºå› ç¼–è¾‘ä¸ä¼ ç»Ÿæ‚äº¤è‚²ç§çš„åŒºåˆ«ï¼Œè¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ",
        options: ["A. ä¸¤è€…éƒ½ä¾èµ–è‡ªç„¶åŸºå› é‡ç»„", "B. åŸºå› ç¼–è¾‘å¯ç²¾å‡†ä¿®æ”¹åŸºå› ï¼Œæ‚äº¤è‚²ç§æ•ˆç‡æ›´ä½", "C. æ‚äº¤è‚²ç§èƒ½ç›´æ¥ä¿®æ”¹åŸºå› åºåˆ—ï¼ŒåŸºå› ç¼–è¾‘ä¸èƒ½", "D. ä¸¤è€…æ“ä½œæˆæœ¬ä¸éš¾åº¦ä¸€è‡´"],
        answer: 1,
        explanation: "ç¬¬ä¸€ç« æŒ‡å‡ºåŸºå› ç¼–è¾‘æ˜¯'ç²¾å‡†ä¿®æ”¹åŸºå› åºåˆ—'ï¼Œä¼ ç»Ÿæ‚äº¤è‚²ç§'ä¾èµ–è‡ªç„¶åŸºå› é‡ç»„ã€æ•ˆç‡ä½'"
      }
    ]
  },
  2: {
    1: {
      title: "2.1 ZFNæŠ€æœ¯ï¼šåŸºå› ç¼–è¾‘çš„'æ—©æœŸæˆç†Ÿå·¥å…·'",
      content: `<div class="section-title">æ ¸å¿ƒåŸç†</div><div class="content-text">ç”±â€œé”ŒæŒ‡è›‹ç™½â€å’Œâ€œæ ¸é…¸é…¶â€ç»„æˆï¼Œé”ŒæŒ‡è›‹ç™½è´Ÿè´£è¯†åˆ«å¹¶ç»“åˆç›®æ ‡åŸºå› ä½ç‚¹ï¼ˆç±»ä¼¼â€œå®šä½å™¨â€ï¼‰ï¼Œæ ¸é…¸é…¶è´Ÿè´£åˆ‡æ–­è¯¥ä½ç‚¹çš„DNAï¼ˆç±»ä¼¼â€œå‰ªåˆ€â€ï¼‰ã€‚</div>`,
      video: '<iframe src="//player.bilibili.com/player.html?isOutside=true&aid=113623577920364&bvid=BV1VmqTYyEfc&cid=31341020777&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="width:100%;height:370px;border-radius:12px;"></iframe>',
      questions: [{ question: "ZFNæŠ€æœ¯çš„ç»„æˆéƒ¨åˆ†ä¸åŒ…æ‹¬ä¸‹åˆ—å“ªä¸€é¡¹ï¼Ÿ", options: ["A. é”ŒæŒ‡è›‹ç™½", "B. æ ¸é…¸é…¶", "C. å‘å¯¼RNAï¼ˆgRNAï¼‰", "D. ç›®æ ‡åŸºå› è¯†åˆ«ç»„ä»¶"], answer: 2, explanation: "ZFNç”±é”ŒæŒ‡è›‹ç™½å’Œæ ¸é…¸é…¶ç»„æˆï¼ŒgRNAæ˜¯CRISPRçš„ç»„ä»¶" }]
    },
    2: {
      title: "2.2 TALENæŠ€æœ¯ï¼šåŸºå› ç¼–è¾‘çš„'ç²¾å‡†è¿›é˜¶å·¥å…·'",
      content: `<div class="section-title">æ ¸å¿ƒåŸç†</div><div class="content-text">ç”±â€œTALEè›‹ç™½â€å’Œâ€œæ ¸é…¸é…¶â€æ„æˆï¼ŒTALEè›‹ç™½çš„æ°¨åŸºé…¸åºåˆ—ä¸åŸºå› åºåˆ—å­˜åœ¨æ˜ç¡®å¯¹åº”å…³ç³»ï¼Œå¯ç²¾å‡†è¯†åˆ«ç›®æ ‡åŸºå› ã€‚</div>`,
      video: '<iframe src="//player.bilibili.com/player.html?isOutside=true&aid=912347871&bvid=BV1NM4y1n7W4&cid=1165656905&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="width:100%;height:370px;border-radius:12px;"></iframe>',
      questions: [{ question: "TALENæŠ€æœ¯ä¸­ï¼Œä¸åŸºå› åºåˆ—å­˜åœ¨'æ˜ç¡®å¯¹åº”å…³ç³»'çš„ç»„ä»¶æ˜¯ï¼Ÿ", options: ["A. æ ¸é…¸é…¶", "B. TALEè›‹ç™½", "C. é”ŒæŒ‡è›‹ç™½", "D. Cas9é…¶"], answer: 1, explanation: "TALEè›‹ç™½çš„æ°¨åŸºé…¸åºåˆ—ä¸åŸºå› åºåˆ—å­˜åœ¨æ˜ç¡®å¯¹åº”å…³ç³»" }]
    },
    3: {
      title: "2.3 CRISPR-Cas9æŠ€æœ¯ï¼šåŸºå› ç¼–è¾‘çš„'æ˜æ˜Ÿå·¥å…·'",
      content: `<div class="section-title">æ ¸å¿ƒåŸç†</div><div class="content-text">é‡‡ç”¨â€œå‘å¯¼RNAï¼ˆgRNAï¼‰+Cas9é…¶â€çš„ç»„åˆï¼ŒgRNAå¦‚åŒâ€œGPSå¯¼èˆªâ€ï¼Œé€šè¿‡ç¢±åŸºäº’è¡¥é…å¯¹è¯†åˆ«å¹¶ç»“åˆç›®æ ‡åŸºå› åºåˆ—ã€‚</div>`,
      video: '<iframe src="//player.bilibili.com/player.html?isOutside=true&aid=37188789&bvid=BV16t411X7qv&cid=65354103&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="width:100%;height:370px;border-radius:12px;"></iframe>',
      questions: [{ question: "CRISPR-Cas9æŠ€æœ¯ä¸­ï¼Œç›¸å½“äº'GPSå¯¼èˆª'åŠŸèƒ½çš„ç»„ä»¶æ˜¯ï¼Ÿ", options: ["A. Cas9é…¶", "B. å‘å¯¼RNAï¼ˆgRNAï¼‰", "C. æ ¸é…¸é…¶", "D. TALEè›‹ç™½"], answer: 1, explanation: "gRNAå¦‚åŒGPSå¯¼èˆªï¼Œè¯†åˆ«ç›®æ ‡åŸºå› åºåˆ—" }]
    },
    4: {
      title: "2.4 æŠ€æœ¯å‡çº§æ–¹å‘ï¼šé™ä½è„±é¶ç‡ä¸æå‡ç²¾å‡†åº¦",
      content: `<div class="section-title">é«˜ç²¾å‡†å·¥å…·ç ”å‘</div><div class="content-text">â€¢ Cas12aé…¶ï¼šå‰ªåˆ‡ä½ç‚¹æ›´çµæ´»<br>â€¢ ç¢±åŸºç¼–è¾‘æŠ€æœ¯ï¼šæ— éœ€åˆ‡æ–­DNAåŒé“¾ï¼Œç›´æ¥å¯¹å•ä¸ªç¢±åŸºè¿›è¡Œä¿®æ”¹</div>`,
      video: '<iframe src="//player.bilibili.com/player.html?isOutside=true&aid=293541894&bvid=BV11f4y17718&cid=423878000&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="width:100%;height:370px;border-radius:12px;"></iframe>',
      questions: [{ question: "ä¸‹åˆ—å“ªç§æŠ€æœ¯å¯'æ— éœ€åˆ‡æ–­DNAåŒé“¾'å³å®ç°åŸºå› ç¼–è¾‘ï¼Ÿ", options: ["A. ZFNæŠ€æœ¯", "B. TALENæŠ€æœ¯", "C. ç¢±åŸºç¼–è¾‘æŠ€æœ¯", "D. CRISPR-Cas9æŠ€æœ¯"], answer: 2, explanation: "ç¢±åŸºç¼–è¾‘æŠ€æœ¯æ— éœ€åˆ‡æ–­DNAåŒé“¾ï¼Œç›´æ¥ä¿®æ”¹å•ä¸ªç¢±åŸº" }]
    }
  },
  3: {
    title: "ç¬¬ä¸‰ç«  åŸºå› ç¼–è¾‘çš„è½åœ°åº”ç”¨åœºæ™¯",
    content: `<div class="section-title">åŒ»ç–—å¥åº·é¢†åŸŸ</div><div class="content-text">â€¢ é—ä¼ ç—…æ²»ç–—ï¼š2023å¹´ç¾å›½æ‰¹å‡†CRISPRç–—æ³•æ²»ç–—é•°çŠ¶ç»†èƒè´«è¡€<br>â€¢ ç™Œç—‡æ²»ç–—ï¼šç¼–è¾‘CAR-Tç»†èƒå¢å¼ºå…ç–«ç»†èƒå¯¹ç™Œç»†èƒçš„è¯†åˆ«èƒ½åŠ›</div>`,
    video: '<iframe src="//player.bilibili.com/player.html?isOutside=true&aid=591840961&bvid=BV1Cq4y167oP&cid=446196437&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="width:100%;height:370px;border-radius:12px;"></iframe>',
    questions: [{ question: "ä¸‹åˆ—å“ªé¡¹å±äºåŸºå› ç¼–è¾‘åœ¨'åŒ»ç–—å¥åº·é¢†åŸŸ'çš„åº”ç”¨ï¼Ÿ", options: ["A. åŸ¹è‚²è€å¹²æ—±çš„æ°´ç¨»å“ç§", "B. ç¼–è¾‘CAR-Tç»†èƒæ²»ç–—ç™½è¡€ç—…", "C. 'é»„é‡‘å¤§ç±³'è¡¥å……ç»´ç”Ÿç´ A", "D. ç¼–è¾‘çŠç‘šåŸºå› æé«˜è€é«˜æ¸©èƒ½åŠ›"], answer: 1, explanation: "ç¼–è¾‘CAR-Tç»†èƒæ²»ç–—ç™½è¡€ç—…å±äºåŒ»ç–—å¥åº·é¢†åŸŸåº”ç”¨" }]
  },
  4: {
    title: "ç¬¬å››ç«  åŸºå› ç¼–è¾‘çš„ä¼¦ç†ä¸å®‰å…¨è¾¹ç•Œ",
    content: `<div class="section-title">å®‰å…¨é£é™©</div><div class="content-text">â€¢ è„±é¶æ•ˆåº”ï¼šè¯¯å‰ªéç›®æ ‡åŸºå› å¯èƒ½å¼•å‘æ–°ç–¾ç—…<br>â€¢ åµŒåˆæ•ˆåº”ï¼šç¼–è¾‘èƒšèƒç»†èƒæ—¶éƒ¨åˆ†ç»†èƒæœªè¢«ç¼–è¾‘</div>`,
    video: '<iframe src="//player.bilibili.com/player.html?isOutside=true&aid=337103505&bvid=BV1mR4y14714&cid=453223121&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="width:100%;height:370px;border-radius:12px;"></iframe>',
    questions: [{ question: "ä¸‹åˆ—å“ªé¡¹å±äºåŸºå› ç¼–è¾‘çš„'åµŒåˆæ•ˆåº”'ï¼Ÿ", options: ["A. è¯¯å‰ªéç›®æ ‡åŸºå› å¯¼è‡´ç»†èƒç™Œå˜", "B. ç¼–è¾‘èƒšèƒç»†èƒæ—¶ï¼Œéƒ¨åˆ†ç»†èƒæœªè¢«ç¼–è¾‘ï¼ŒåŒæ—¶å«ä¸¤ç§ç»†èƒ", "C. åŸºå› ç¼–è¾‘å½±å“åä»£çš„é—ä¼ ä¿¡æ¯", "D. ç¼–è¾‘å…ç–«ç»†èƒåï¼Œç»†èƒåŠŸèƒ½å¼‚å¸¸"], answer: 1, explanation: "åµŒåˆæ•ˆåº”æŒ‡ç¼–è¾‘èƒšèƒç»†èƒæ—¶éƒ¨åˆ†ç»†èƒæœªè¢«ç¼–è¾‘ï¼Œå½¢æˆåŒæ—¶å«ç¼–è¾‘ä¸æœªç¼–è¾‘ç»†èƒçš„åµŒåˆä½“" }]
  },
  5: {
    title: "ç¬¬äº”ç«  åŸºå› ç¼–è¾‘çš„æœªæ¥å±•æœ›ä¸æŒ‘æˆ˜",
    content: `<div class="section-title">æŠ€æœ¯å‡çº§æ–¹å‘</div><div class="content-text">â€¢ æ–°å‹å·¥å…·ï¼šCas14é…¶ä½“ç§¯æ›´å°ï¼Œå¯è¿›å…¥æ›´å¾®å°ç»†èƒç»“æ„<br>â€¢ å¼•å¯¼ç¼–è¾‘æŠ€æœ¯ï¼šç»“åˆgRNAä¸é€†è½¬å½•é…¶ï¼Œå®ç°ç²¾å‡†æ’å…¥/æ›¿æ¢</div>`,
    video: '<iframe src="//player.bilibili.com/player.html?isOutside=true&aid=299797100&bvid=BV1JF411V7FA&cid=740330356&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="width:100%;height:370px;border-radius:12px;"></iframe>',
    questions: [{ question: "ä¸‹åˆ—å“ªç§æ–°å‹å·¥å…·'ä½“ç§¯ä»…ä¸ºCas9çš„1/3ï¼Œå¯è¿›å…¥æ›´å¾®å°çš„ç»†èƒç»“æ„'ï¼Ÿ", options: ["A. Cas12aé…¶", "B. Cas14é…¶", "C. ç¢±åŸºç¼–è¾‘å·¥å…·", "D. ZFNå·¥å…·"], answer: 1, explanation: "Cas14é…¶ä½“ç§¯ä»…ä¸ºCas9çš„1/3ï¼Œå¯è¿›å…¥æ›´å¾®å°çš„ç»†èƒç»“æ„è¿›è¡Œç¼–è¾‘" }]
  }
};

// ===== é¡µé¢åˆ‡æ¢ =====
function hideAllPages() {
  const pages = ['homePage', 'chapterPage', 'quizPage', 'resultPage', 'qaPage'];
  pages.forEach(id => document.getElementById(id).classList.remove('active'));
}

function showHome() {
  hideAllPages();
  document.getElementById('homePage').classList.add('active');
}

function showChapter(chapter) {
  currentChapter = chapter;
  currentSection = null;
  const data = courseData[chapter];
  renderChapter(data);
}

function showSection(chapter, section) {
  currentChapter = chapter;
  currentSection = section;
  const data = courseData[chapter][section];
  renderChapter(data);
}

function renderChapter(data) {
  hideAllPages();
  document.getElementById('chapterTitle').textContent = data.title;
  document.getElementById('chapterContent').innerHTML = data.content;
  document.getElementById('videoContainer').innerHTML = data.video || '<div class="video-placeholder">ğŸ“¹ è§†é¢‘åŠ è½½åŒºåŸŸ</div>';
  document.getElementById('chapterPage').classList.add('active');
  currentQuizQuestions = data.questions;
}

function showQA() {
  hideAllPages();
  document.getElementById('qaPage').classList.add('active');
}

function startQuizFromHome() {
  currentChapter = 1;
  currentSection = null;
  currentQuizQuestions = courseData[1].questions;
  startQuiz();
}

function startQuiz() {
  hideAllPages();
  const quizContent = document.getElementById('quizContent');
  quizContent.innerHTML = '';
  userAnswers = [];
  currentQuizQuestions.forEach((q, index) => {
    const div = document.createElement('div');
    div.className = 'quiz-question';
    div.innerHTML = `
      <div class="question-text"><strong>${index + 1}. ${q.question}</strong></div>
      <ul class="quiz-options">
        ${q.options.map((opt, i) => `
          <li onclick="selectAnswer(${index}, ${i})" data-q="${index}" data-o="${i}">${opt}</li>
        `).join('')}
      </ul>
    `;
    quizContent.appendChild(div);
  });
  document.getElementById('quizPage').classList.add('active');
}

function selectAnswer(qIndex, oIndex) {
  userAnswers[qIndex] = oIndex;
  const options = document.querySelectorAll(`[data-q="${qIndex}"]`);
  options.forEach(opt => opt.classList.remove('selected'));
  options[oIndex].classList.add('selected');
}

function submitQuiz() {
  if (userAnswers.length !== currentQuizQuestions.length) {
    alert('è¯·å®Œæˆæ‰€æœ‰é¢˜ç›®ï¼');
    return;
  }
  let correct = 0, resultHTML = '';
  currentQuizQuestions.forEach((q, i) => {
    const isCorrect = userAnswers[i] === q.answer;
    if (isCorrect) correct++;
    resultHTML += `
      <div style="margin-bottom:15px; padding:15px; background:${isCorrect ? '#e8f5e8' : '#ffeaea'}; border-radius:8px;">
        <strong>ç¬¬${i + 1}é¢˜ï¼š</strong>${q.question}<br>
        <strong>ä½ çš„ç­”æ¡ˆï¼š</strong>${q.options[userAnswers[i]]}<br>
        <strong>æ­£ç¡®ç­”æ¡ˆï¼š</strong>${q.options[q.answer]}<br>
        ${!isCorrect ? `<strong>è§£æï¼š</strong>${q.explanation}` : ''}
      </div>
    `;
  });
  const score = Math.round((correct / currentQuizQuestions.length) * 100);
  document.getElementById('scoreDisplay').textContent = `${score}åˆ†`;
  document.getElementById('resultDetails').innerHTML = resultHTML;
  hideAllPages();
  document.getElementById('resultPage').classList.add('active');
}

function retryQuiz() {
  startQuiz();
}

function nextChapter() {
  if (currentChapter === 1) {
    showChapter(2);
  } else if (currentChapter === 2) {
    showChapter(3);
  } else if (currentChapter === 3) {
    showChapter(4);
  } else if (currentChapter === 4) {
    showChapter(5);
  } else {
    alert('å·²ç»æ˜¯æœ€åä¸€ç« äº†ï¼');
    showHome();
  }
}

// ===== çœŸå® Kimi API æ¥å…¥ =====
async function submitQuestion() {
  const question = document.getElementById('questionInput').value.trim();
  if (!question) return alert('è¯·è¾“å…¥é—®é¢˜ï¼');
  const responseDiv = document.getElementById('qaResponse');
  responseDiv.style.display = 'block';
  responseDiv.innerHTML = '<p>æ­£åœ¨æ€è€ƒä¸­...</p>';

  if (!MOONSHOT_API_KEY || MOONSHOT_API_KEY === 'sk-cxZWMrksa7UkLCmafSQ8CZ6PD30UFe3nu95l89LsXVTuTW9k') {
    responseDiv.innerHTML = `<h3>æç¤º</h3><p>è¯·å…ˆç”³è¯· Moonshot API Key å¹¶æ›¿æ¢ä»£ç ä¸­çš„ <code>MOONSHOT_API_KEY</code></p>`;
    return;
  }

  try {
    const res = await fetch('https://api.moonshot.cn/v1/chat/completions', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${MOONSHOT_API_KEY}`
      },
      body: JSON.stringify({
        model: 'moonshot-v1-8k',
        messages: [
          { role: 'system', content: 'ä½ æ˜¯ä¸€ä¸ªåŸºå› ç¼–è¾‘ç§‘æ™®åŠ©æ‰‹ï¼Œå›ç­”ç®€æ´ã€å‡†ç¡®ã€é€šä¿—æ˜“æ‡‚ã€‚' },
          { role: 'user', content: question }
        ],
        temperature: 0.7,
        max_tokens: 500
      })
    });

    const data = await res.json();
    const answer = data.choices[0].message.content;
    responseDiv.innerHTML = `<h3>å›ç­”ï¼š</h3><p>${answer}</p>`;
  } catch (err) {
    responseDiv.innerHTML = `<h3>å‡ºé”™</h3><p>æ— æ³•è·å–å›ç­”ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–API Keyã€‚</p>`;
  }
}

</script>
</body>
</html>